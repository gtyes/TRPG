<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TRPG日志编辑器</title>
    <link rel="stylesheet" href="styles/editor.css">
</head>
<body>
    <div class="editor-container">
        <!-- 侧边栏 -->
        <div class="sidebar">
            <h2>📝 TRPG日志编辑器</h2>
            
            <div class="room-input-section">
                <h3>加载房间</h3>
                <input type="text" id="roomIdInput" placeholder="输入ccfolia房间ID">
                <button id="loadRoomBtn">加载原始日志</button>
            </div>

            <div class="saved-rooms-section">
                <h3>已保存的房间</h3>
                <div id="savedRoomsList"></div>
            </div>

            <!-- 新增：样式设置面板 -->
            <div class="style-settings-section">
                <h3>样式设置</h3>
                <button id="styleSettingsBtn">打开样式设置</button>
            </div>

            <div class="edit-tools">
                <h3>编辑工具</h3>
                <button id="addMessageBtn">添加新消息</button>
                <button id="addChapterBtn">添加章节</button>
                <button id="importJsonBtn">导入JSON</button>
                <button id="exportJsonBtn">导出JSON</button>
                <button id="saveToBlogBtn" class="primary">保存到博客</button>
            </div>

            <div class="stats">
                <h3>统计信息</h3>
                <div id="statsInfo"></div>
            </div>
        </div>

        <!-- 主编辑区 -->
        <div class="main-content">
            <div class="toolbar">
                <input type="text" id="roomTitle" placeholder="房间标题">
                <input type="text" id="roomDescription" placeholder="房间描述">
                
                <!-- 分页控件 -->
                <div class="pagination-controls">
                    <button id="prevPageBtn">上一页</button>
                    <span id="pageInfo">第 1 页</span>
                    <button id="nextPageBtn">下一页</button>
                    <select id="pageSizeSelect">
                        <option value="20">20条/页</option>
                        <option value="50" selected>50条/页</option>
                        <option value="100">100条/页</option>
                        <option value="200">200条/页</option>
                    </select>
                </div>

                <button id="previewBtn">预览</button>
                <button id="publishBtn" class="publish-btn">发布更新</button>
            </div>

            <div class="messages-editor">
                <div id="messagesList" class="messages-list">
                    <div class="empty-state">
                        <p>请先加载一个房间或创建新的日志</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 添加消息的模态框 -->
    <div id="addMessageModal" class="modal">
        <div class="modal-content">
            <h3>添加新消息</h3>
            <form id="addMessageForm">
                <input type="text" name="characterName" placeholder="角色名" required>
                <input type="color" name="characterColor" value="#666666">
                <textarea name="content" placeholder="消息内容" required></textarea>
                <div class="modal-actions">
                    <button type="submit">添加</button>
                    <button type="button" onclick="closeModal('addMessageModal')">取消</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 添加章节的模态框 -->
    <div id="addChapterModal" class="modal">
        <div class="modal-content">
            <h3>添加章节</h3>
            <form id="addChapterForm">
                <input type="text" name="chapterTitle" placeholder="章节标题" required>
                <textarea name="chapterDescription" placeholder="章节描述（可选）"></textarea>
                <div class="modal-actions">
                    <button type="submit">添加章节</button>
                    <button type="button" onclick="closeModal('addChapterModal')">取消</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 样式设置模态框 -->
    <div id="styleSettingsModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <h3>样式设置</h3>
            
            <div class="style-tabs">
                <button class="tab-button active" data-tab="background">背景设置</button>
                <button class="tab-button" data-tab="channel">频道设置</button>
                <button class="tab-button" data-tab="characters">角色设置</button>
            </div>

            <div class="tab-content">
                <!-- 背景设置 -->
                <div id="background-tab" class="tab-pane active">
                    <div class="setting-group">
                        <h4>网页背景</h4>
                        <label>
                            <input type="radio" name="bgType" value="color" checked> 颜色
                            <input type="color" id="pageBgColor" value="#667eea">
                        </label>
                        <label>
                            <input type="radio" name="bgType" value="gradient"> 渐变
                            <input type="color" id="pageBgColor1" value="#667eea">
                            <input type="color" id="pageBgColor2" value="#764ba2">
                        </label>
                        <label>
                            <input type="radio" name="bgType" value="image"> 图片
                            <input type="file" id="pageBgImage" accept="image/*">
                            <button onclick="document.getElementById('pageBgImage').click()">选择图片</button>
                        </label>
                    </div>

                    <div class="setting-group">
                        <h4>日志容器背景</h4>
                        <label>
                            <input type="radio" name="containerBgType" value="color" checked> 颜色
                            <input type="color" id="containerBgColor" value="#ffffff">
                        </label>
                        <label>
                            <input type="radio" name="containerBgType" value="image"> 图片
                            <input type="file" id="containerBgImage" accept="image/*">
                            <button onclick="document.getElementById('containerBgImage').click()">选择图片</button>
                        </label>
                        <label>
                            透明度:
                            <input type="range" id="containerOpacity" min="0" max="100" value="100">
                            <span id="containerOpacityValue">100%</span>
                        </label>
                    </div>
                </div>

                <!-- 频道设置 -->
                <div id="channel-tab" class="tab-pane">
                    <div class="setting-group">
                        <h4>频道背景色</h4>
                        <div id="channelSettings">
                            <!-- 动态生成的频道设置 -->
                        </div>
                        <button onclick="logEditor.addChannelSetting()">添加频道</button>
                    </div>
                </div>

                <!-- 角色设置 -->
                <div id="characters-tab" class="tab-pane">
                    <div class="setting-group">
                        <h4>角色设置</h4>
                        <div id="characterSettings">
                            <!-- 动态生成的角色设置 -->
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-actions">
                <button onclick="logEditor.applyStyleSettings()">应用样式</button>
                <button onclick="closeModal('styleSettingsModal')">关闭</button>
            </div>
        </div>
    </div>

    <script src="scripts/editor.js"></script>
</body>
</html>